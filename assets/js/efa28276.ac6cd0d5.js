"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[5666],{1383:(t,n,e)=>{e.d(n,{$p:()=>u,Rb:()=>p,WP:()=>m,lN:()=>h,o4:()=>f,q8:()=>c,r5:()=>w,uB:()=>g});var o=e(7823),i=e(842),r=e(9699),s=e(1997);function a(t){return t*(Math.PI/180)}function l(t){return t*(180/Math.PI)}function c(t){return[i.Bw(t),Math.atan2(t[1],t[0])]}function u(t){let[n,e]=t;return[n*Math.cos(e),n*Math.sin(e)]}function f(t){return i.ZF(i.vt(),t,s.wc)}function h(t){const n=Math.atan2(t[1],t[0]),e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return[n,Math.acos(t[2]/e)]}function g(t){let[n,e]=t;return[Math.sin(e)*Math.cos(n),Math.sin(e)*Math.sin(n),Math.cos(e)]}o.fG(Float64Array);const d=93;function p(t){let[n,e]=t;return[a(n+d),a(90-e)]}function m(t){let[n,e]=t;return[l(n)-d,90-l(e)]}function w(t){const n=g(t),e=r.vt();return r.Yc(e,[0,0,1],n),e}},1921:(t,n,e)=>{e.d(n,{u$:()=>P,WH:()=>k,ce:()=>y});var o=e(7823),i=e(3522),r=e(842),s=e(1383),a=e(3243),l=e(6864),c=e(1970),u=e(1997),f=e(1148),h=e(3255);o.fG(Float64Array);const g=!1,d=r.o8(u.w),p=r.ze(r.vt(),u.w),m=[0,1,2,3,4].map((t=>{const n=i.vt();return i.$0(n,f.UT*t),n})),w=r.vt();o.fG(Float64Array);const v=i.vt();function x(t,n){const e=(0,s.q8)(t),o=(0,l.s)(e,n.quat,n.angle),c=(0,a.jS)(o,n)?n:(0,a.Sj)(o);if(c.id!==n.id){const e=r.vt();i.$0(v,n.angle),r.ZF(e,t,v);const{point:u,quat:h}=(0,a.MQ)(e,n,c);let g=0;n.angle!==c.angle&&0!==c.angle&&(g=-f.R);let d=(0,s.q8)(u);d[1]=d[1]-g;const p=(0,l.s)(d,h,g);o[0]=p[0],o[1]=p[1]}return(0,s.WP)(o)}function b(t,n){const e=t.getVertices().map((t=>x(t,n)));return c.c.normalizeLongitudes(e)}var M=e(2189);o.fG(Float64Array);const j=i.vt();function y(t,n){const e=1+n-M.To,o=[t],i=50/Math.pow(2,e);for(let c=0;c<25;c++){const n=c/25*i,e=r.fA(Math.cos(c)*n,Math.sin(c)*n);r.WQ(e,e,t),o.push(e)}const s=[];for(const r of o){const e=S(r,n);if(n<M.To||T(e,t))return(0,M.lK)(e);s.push(e)}let a=1/0,l=null;for(const c of s){const n=x(A(c).getCenter(),c.origin),e=r.xg(n,t);e<a&&(a=e,l=c)}if(l)return(0,M.lK)(l);throw new Error("No cell found")}function S(t,n){const e=(0,s.Rb)(t),o={...(0,a.Sj)(e)};i.$0(j,-o.angle);const c=(0,l.r)(e,o.quat,o.angle),g=(0,s.$p)(c),d=function(t){const n=(Math.atan2(t[1],t[0])-u.V+f.JM)%f.JM;return Math.ceil(n/f.UT)%5}(g),{segment:p,orientation:m}=(0,a.b5)(d,o);if(n<M.To)return{S:0n,segment:p,origin:o,resolution:n};if(0!==d){const t=2*f.R*d;i.$0(j,-t),r.ZF(g,g,j)}const w=1+n-M.To;r.hs(g,g,2**w);const v=(0,s.o4)(g);return{S:(0,h.eS)(v,w,m),segment:p,origin:o,resolution:n}}function A(t){let{S:n,segment:e,origin:o,resolution:i}=t;const{quintant:s,orientation:l}=(0,a.BL)(e,o);if(i===M.To-1){const t=function(t){const n=u.LF.clone();return n.transform(m[t]),n}(s);return t}if(i===M.To-2)return function(){const t=[];for(const n of m)t.push(r.ZF(r.vt(),u.v,n));return new c.c(t)}();const f=i-M.To+1;return function(t,n,e){const o=(g?u.LF:u.tK).clone();r.ZF(w,e.offset,u.P9),e.flips[0]===h.NO&&e.flips[1]===h._Y&&o.rotate180();const{k:i}=e,s=e.flips[0]+e.flips[1];return((-2===s||2===s)&&i>1||0===s&&(0===i||3===i))&&o.reflectY(),e.flips[0]===h._Y&&e.flips[1]===h._Y?o.rotate180():e.flips[0]===h._Y?o.translate(p):e.flips[1]===h._Y&&o.translate(d),o.translate(w),o.scale(1/2**t),o.transform(m[n]),o}(f,s,(0,h.ky)(n,f,l))}function k(t){const{S:n,segment:e,origin:o,resolution:i}=(0,M.iu)(t),r=x(A({S:n,segment:e,origin:o,resolution:i}).getCenter(),o);return c.c.normalizeLongitudes([r])[0]}function P(t){const{S:n,segment:e,origin:o,resolution:i}=(0,M.iu)(t);return b(A({S:n,segment:e,origin:o,resolution:i}),o)}function T(t,n){const e=b(A(t),t.origin);return new c.c(e).containsPoint(n)}},2189:(t,n,e)=>{e.d(n,{To:()=>i,iu:()=>l,lK:()=>c,s7:()=>f,xZ:()=>u});var o=e(3243);const i=3,r=31,s=58n,a=0x3ffffffffffffffn;function l(t){const n=function(t){let n=r-1,e=t>>1n;for(;n>0&&0n===(0b1n&e);)n-=1,e>>=n<i?1n:2n;return n}(t);if(0===n)return{origin:o.kt[0],segment:0,S:0n,resolution:n};const e=Number(t>>58n);let l,c;if(1===n){const t=e;l=o.kt[t],c=0}else{const t=Math.floor(e/5);l=o.kt[t],c=(e+l.firstQuintant)%5}if(!l)throw new Error(`Could not parse origin: ${e}`);if(n<i)return{origin:l,segment:c,S:0n,resolution:n};const u=BigInt(2*(n-i+1));return{origin:l,segment:c,S:(t&a)>>s-u,resolution:n}}function c(t){const{origin:n,segment:e,S:o,resolution:a}=t;if(a>r)throw new Error(`Resolution (${a}) is too large`);if(0===a)return 0n;let l;if(a<i)l=BigInt(a);else{l=BigInt(2*(1+a-i)+1)}const c=(e-n.firstQuintant+5)%5;let u;if(u=1===a?BigInt(n.id)<<58n:BigInt(5*n.id+c)<<58n,a>=i){const t=BigInt(2*(a-i+1));if(BigInt(o)>=1n<<t)throw new Error(`S (${o}) is too large for resolution level ${a}`);u+=BigInt(o)<<s-t}return u|=1n<<s-l,u}function u(t,n){const{origin:e,segment:s,S:a,resolution:u}=l(t),f=n??u+1;if(f<=u)throw new Error(`Target resolution (${f}) must be greater than current resolution (${u})`);if(f>r)throw new Error(`Target resolution (${f}) exceeds maximum resolution (${r})`);let h=[e],g=[s];0===u&&(h=o.kt),(0===u&&f>1||1===u)&&(g=[0,1,2,3,4]);const d=f-Math.max(u,i-1),p=Math.pow(4,d),m=[],w=a<<BigInt(2*d);for(const o of h)for(const t of g)for(let n=0;n<p;n++){const e=w+BigInt(n);m.push(c({origin:o,segment:t,S:e,resolution:f}))}return m}function f(t,n){const{origin:e,segment:o,S:i,resolution:r}=l(t),s=n??r-1;if(s<0)throw new Error(`Target resolution (${s}) cannot be negative`);if(s>=r)throw new Error(`Target resolution (${s}) must be less than current resolution (${r})`);return c({origin:e,segment:o,S:i>>BigInt(2*(r-s)),resolution:s})}},3243:(t,n,e)=>{e.d(n,{BL:()=>M,MQ:()=>j,Sj:()=>y,b5:()=>b,jS:()=>S,kt:()=>w});var o=e(7823),i=e(9699),r=e(329),s=e(842),a=e(1383),l=e(1148);o.fG(Float64Array);const c=[0,0,1],u=["vu","uw","vw","vw","vw"],f=["wu","uw","vw","vu","uw"],h=["wu","uv","wv","wu","uw"],g=["vu","uv","wv","wu","uw"],d=[u,g,h,f,h,g,h,f,f,f,g,g],p=[4,2,3,2,0,4,3,2,2,0,3,0],m=[0,1,2,4,3,5,7,8,6,11,10,9],w=[];let v=0;function x(t,n){const e={id:v,axis:t,quat:(0,a.r5)(t),angle:n,orientation:d[v],firstQuintant:p[v]};w.push(e),v++}function b(t,n){const e=n.orientation,o=((e===u||e===f?-1:1)*((t-n.firstQuintant+5)%5)+5)%5,i=e[o];return{segment:(n.firstQuintant+o)%5,orientation:i}}function M(t,n){const e=n.orientation,o=e===u||e===f?-1:1,i=(t-n.firstQuintant+5)%5,r=e[i];return{quintant:(n.firstQuintant+o*i+5)%5,orientation:r}}function j(t,n,e){const o=i.vt();i.B8(o,n.quat);const u=(0,a.uB)(e.axis),f=r.vt();r.gL(f,u,o);const h=s.vt();s.S8(h,[f[0],f[1]]),s.hs(h,h,2*l.mN);const g=s.vt();s.Re(g,t,h);const d=i.vt();return i.Yc(d,c,f),i.lw(d,n.quat,d),{point:g,quat:d}}function y(t){let n=1/0,e=w[0];for(const o of w){const i=A(t,o.axis);i<n&&(n=i,e=o)}return e}function S(t,n){return A(t,n.axis)>.49}function A(t,n){const[e,o]=t,[i,r]=n,s=i-e,a=r-o,l=Math.sin(a/2),c=Math.sin(s/2);return l*l+c*c*Math.sin(o)*Math.sin(r)}!function(){x([0,0],0);for(let t=0;t<5;t++){const n=t*l.UT,e=n+l.R;x([n,l.Kk],l.R),x([e,Math.PI-l.Kk],l.R)}x([0,Math.PI],0)}(),w.sort(((t,n)=>m.indexOf(t.id)-m.indexOf(n.id))),w.forEach(((t,n)=>t.id=n))},3255:(t,n,e)=>{e.d(n,{NO:()=>s,_Y:()=>r,eS:()=>x,ky:()=>m});var o=e(7823),i=e(842);o.fG(Float64Array);const r=-1,s=1,a=t=>{let[n,e]=t;return i.fA(n-e,e)},l=i.fA(1,0),c=i.fA(0,1),u=i.ze(i.vt(),l),f=i.ze(i.vt(),c),h=i.fA(0,0),g=(t,n)=>{let[e,o]=n,a=h,g=h;switch(e===s&&o===s?(a=l,g=c):e===r&&o===s?(a=f,g=u):e===s&&o===r?(a=c,g=l):e===r&&o===r&&(a=u,g=f),t){case 0:return h;case 1:return a;case 2:return i.WQ(i.vt(),g,a);case 3:return i.Ln(i.vt(),g,a,2);default:throw new Error(`Invalid Quaternary value: ${t}`)}},d=t=>[[s,s],[s,r],[s,s],[r,s]][t],p=i.fA(-1,1),m=(t,n,e)=>{let o=BigInt(t);const s="wv"===e||"vw"===e,a="wu"===e||"uw"===e;("vu"===e||"wu"===e||"vw"===e)&&(o=(1n<<BigInt(2*n))-o-1n);const l=w(o);if(a){const{offset:[t,n],flips:[e,o]}=l;l.offset=[n,t],e===r&&i.WQ(l.offset,l.offset,p),o===r&&i.Re(l.offset,l.offset,p)}if(s){const{offset:[t,e],flips:o}=l,i=(1<<n)-(t+e);o[0]=-o[0],l.offset[1]=i,l.flips=o}return l},w=t=>{const n=Number(t)%4,e=i.vt(),o=[s,s];let r=BigInt(t);const l=[];for(;r>0n;)l.push(Number(r%4n)),r>>=2n;for(let s=l.length-1;s>=0;s--){i.hs(e,e,2);const t=g(l[s],o);i.WQ(e,e,t),i.lw(o,o,d(l[s]))}return{flips:o,k:n,offset:a(e)}},v=(t,n)=>{let[e,o]=t,i=0,s=n[0]===r?-(e+o):e+o,a=n[1]===r?-e:e,l=n[0]===r?-o:o;return i=n[0]+n[1]===0?l<1?0:a>1?3:s>1?2:1:s<1?0:a>1?3:l>1?2:1,i},x=function(t,n,e){void 0===e&&(e="uv");const o="vu"===e||"wu"===e||"vw"===e,i="wv"===e||"vw"===e,r="wu"===e||"uw"===e;let s=[...t];if(r&&(s[0]=t[1],s[1]=t[0]),i){const[t,e]=s;s[1]=(1<<n)-(t+e)}let a=b(s);return o&&(a=(1n<<BigInt(2*n))-a-1n),a},b=t=>{const n=(t=>{const n=Math.ceil(t[0])+Math.ceil(t[1]);return 0===n?1:1+Math.floor(Math.log2(n))})(t),e=new Array(n),o=[s,s],r=i.vt();for(let s=0;s<n;s++){const l=i.Re(i.vt(),t,r),c=1<<n-1-s,u=i.hs(i.vt(),l,1/c),f=v(u,o);e[s]=f;const h=a(g(f,o)),p=i.hs(i.vt(),h,c);i.WQ(r,r,p),i.lw(o,o,d(f))}let l=0n;for(let i=0;i<n;i++){const t=1n<<BigInt(2*(n-1-i));l+=BigInt(e[i])*t}return l}},4125:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>C,contentTitle:()=>I,default:()=>F,frontMatter:()=>B,metadata:()=>o,toc:()=>$});const o=JSON.parse('{"id":"airbnb","title":"Airbnb","description":"","source":"@site/src/examples/airbnb.mdx","sourceDirName":".","slug":"/airbnb","permalink":"/examples/airbnb","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"examplesSidebar","previous":{"title":"Overview","permalink":"/examples/"},"next":{"title":"Populated Places","permalink":"/examples/populated-places"}}');var i=e(4848),r=e(8453),s=e(6540),a=e(4258),l=(e(5338),e(9533)),c=e(3727),u=e(3537),f=e(1457),h=e(5890),g=e(5815),d=e(435),p=e(1921),m=e(5212),w=e(4923);const v="/data/malta.json",x="/data/oslo.json",b=[[211,242,163],[151,225,150],[108,192,139],[76,155,130],[33,122,121],[16,89,101],[7,64,80]],M={athens:{longitude:14.385,latitude:35.87,pitch:30,bearing:240,zoom:10.5},oslo:{longitude:10.85,latitude:60,pitch:30,bearing:40,zoom:9.8}},j=t=>{let{dataUrl:n,initialViewState:e,layerType:o,globalMaxCount:r,tilingSystem:a,aggregatedData:c,center:w,labelPosition:v}=t;const[x,M]=(0,s.useState)(null);if((0,s.useEffect)((()=>{fetch(n).then((t=>t.json())).then(M)}),[n]),!x)return null;const j={pickable:!0,autoHighlight:!0,highlightColor:[255,255,255,255],visible:"cells"===o},y=new u.A({id:"airbnb-points",data:x,getPosition:t=>t,getFillColor:b[0],getRadius:1,radiusUnits:"pixels",visible:"points"===o}),S=new g.A({id:"airbnb-heatmap",data:x,getPosition:t=>t,getWeight:1,radiusPixels:25,intensity:1,threshold:.05,colorRange:b,visible:"heatmap"===o}),k=new u.A({id:"center-point",data:[w],getPosition:t=>t,getLineColor:[255,255,255,200],getRadius:1e4,radiusUnits:"meters",stroked:!0,filled:!1,lineWidthMinPixels:2,pickable:!1}),P=new f.A({id:"circle-label",data:[v],getPosition:t=>t,getText:t=>"10km",getColor:[255,255,255,200],getSize:16,fontFamily:"Arial, sans-serif",fontSettings:{sdf:!0,buffer:8},pickable:!1}),T={getFillColor:(0,d.A)({attr:t=>Math.sqrt(t.count),domain:[0,Math.sqrt(r)],colors:"Emrld"}),getLineColor:[255,255,255,200],stroked:!0,wireframe:!0,getElevation:t=>25e3*t.count/r,extruded:!0},B="a5"===a?new h.A({id:"airbnb-cells",data:c.a5.cells,getPolygon:t=>(0,p.u$)(t.id),...T,...j}):new m.A({id:"airbnb-cells",data:c.h3.cells,getHexagon:t=>t.id,...T,...j});return(0,i.jsx)("div",{style:{width:"50%",height:"100%",position:"relative"},children:(0,i.jsx)(l.T5,{id:"map",initialViewState:e,boxZoom:!1,scrollZoom:!1,minPitch:e.pitch,maxPitch:e.pitch,mapStyle:"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",children:(0,i.jsx)(A,{layers:[B,y,S,k,P],interleaved:!1,getTooltip:t=>{let{object:n}=t;return n?{html:`<div>Listings: ${n.count}</div>`,style:{backgroundColor:"white",padding:"8px",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"}}:null}})})})},y=()=>{const[t,n]=(0,s.useState)("a5"),[e,o]=(0,s.useState)(null),[r,a]=(0,s.useState)({a5:0,h3:0});(0,s.useEffect)((()=>{(async()=>{const[t,n]=await Promise.all([fetch(v).then((t=>t.json())),fetch(x).then((t=>t.json()))]),e=t=>{const n=t.map((t=>({id:(0,p.ce)(t,14),count:1}))),e=new Map;let o=0;for(const a of n){const{id:t}=a;e.has(t)?e.get(t).count+=1:e.set(t,a),o=Math.max(o,e.get(t).count)}const i=t.map((t=>({id:(0,w.Sg)(t[1],t[0],8),count:1}))),r=new Map;let s=0;for(const a of i){const{id:t}=a;r.has(t)?r.get(t).count+=1:r.set(t,a),s=Math.max(s,r.get(t).count)}return{a5:{cells:[...e.values()],maxCount:o},h3:{cells:[...r.values()],maxCount:s}}},i=e(t),r=e(n);o({malta:i,oslo:r}),a({a5:Math.max(i.a5.maxCount,r.a5.maxCount),h3:Math.max(i.h3.maxCount,r.h3.maxCount)})})()}),[]);const l=t=>{let{viewType:n,setViewType:e}=t;return(0,i.jsx)("div",{style:{position:"absolute",top:"20px",left:"20px",zIndex:1,background:"white",padding:"10px",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{marginRight:"8px"},children:"View:"}),(0,i.jsxs)("select",{value:n,onChange:t=>e(t.target.value),style:{padding:"4px"},children:[(0,i.jsx)("option",{value:"points",children:"Points"}),(0,i.jsx)("option",{value:"a5",children:"A5 (Pentagons)"}),(0,i.jsx)("option",{value:"h3",children:"H3 (Hexagons)"}),(0,i.jsx)("option",{value:"heatmap",children:"Heatmap"})]})]})})};return e?(0,i.jsxs)("div",{style:{position:"absolute",height:"100%",width:"100%",top:0,left:0,background:"linear-gradient(0, #000, #223)",display:"flex"},children:[(0,i.jsx)(j,{dataUrl:v,initialViewState:M.athens,layerType:"points"===t?"points":"heatmap"===t?"heatmap":"cells",globalMaxCount:r["a5"===t?"a5":"h3"],tilingSystem:"a5"===t?"a5":"h3",aggregatedData:e.malta,center:[14.4923,35.9139],labelPosition:[14.49,35.989]}),(0,i.jsx)(j,{dataUrl:x,initialViewState:M.oslo,layerType:"points"===t?"points":"heatmap"===t?"heatmap":"cells",globalMaxCount:r["a5"===t?"a5":"h3"],tilingSystem:"a5"===t?"a5":"h3",aggregatedData:e.oslo,center:[10.7522,59.9139],labelPosition:[10.61,59.88]}),(0,i.jsx)(l,{viewType:t,setViewType:n})]}):null},S=y;function A(t){return(0,l.VI)((()=>new c.A(t))).setProps(t),null}var k=e(999);class P extends s.Component{static title="Airbnb";static code=(()=>`${a.l}/examples/website/airbnb`)();static parameters={};static renderInfo(t){return(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:"Aggregated AirBnb listing in Malta vs Oslo."}),(0,i.jsx)("p",{children:"Due to the unequal cell sizes, H3 incorrectly suggests that in Malta the density of rental apartments is twice that of Oslo."}),(0,i.jsx)("p",{children:"It can also been seen how the cell sizes are different for H3, while with A5 they are equal."}),(0,i.jsxs)("p",{children:["Data: ",(0,i.jsx)("a",{href:"https://insideairbnb.com/get-the-data/",children:"Inside Airbnb"})]})]})}render(){return(0,i.jsx)("div",{style:{width:"100%",height:"100%",position:"absolute",background:"#111"},children:(0,i.jsx)(S,{...this.props})})}}const T=(0,k.xv)(P),B={},I="Airbnb",C={},$=[];function R(t){const n={h1:"h1",header:"header",...(0,r.R)(),...t.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"airbnb",children:"Airbnb"})}),"\n","\n",(0,i.jsx)(T,{})]})}function F(t={}){const{wrapper:n}={...(0,r.R)(),...t.components};return n?(0,i.jsx)(n,{...t,children:(0,i.jsx)(R,{...t})}):R(t)}},6864:(t,n,e)=>{e.d(n,{s:()=>m,r:()=>w});var o=e(7823),i=e(329),r=e(9699),s=e(1383),a=e(1148);function l(t){const n=t/a.UT;return(n-Math.round(n))*a.UT}function c(t){const n=t*a.ZP;return Math.tan(n)}const u=a.R,f=c(u)/u;function h(t){return function(t){return Math.atan(t)/a.ZP}(t*f)}function g(t,n){const e=t*(.95-.05*(Math.abs(n)/u));return Math.tan(e)}function d(t){let[n,e]=t;const o=l(e),i=function(t){return c(t)/f}(l(e)),r=i-o,s=Math.cos(o)/Math.cos(i)*n,u=a.mN/Math.cos(i),h=g(u,i)/u;return[g(s,i)/h,e+r]}function p(t){let[n,e]=t;const o=l(e),i=h(o),r=o-i,s=a.mN/Math.cos(o),c=function(t,n){const e=Math.abs(n)/u;return Math.atan(t)/(.95-.05*e)}(n*(g(s,o)/s),o);return[c/(Math.cos(i)/Math.cos(o)),e-r]}function m(t,n,e){const[o,r]=d(t),a=function(t){let[n,e]=t;return[e,Math.atan(n)]}([o,r+e]),l=(0,s.uB)(a);return i.gL(l,l,n),(0,s.lN)(l)}function w(t,n,e){const[o,a,l]=(0,s.uB)(t),c=r.vt();r.B8(c,n);const u=i.vt();i.gL(u,[o,a,l],c);const f=function(t){let[n,e]=t;return[Math.tan(e),n]}((0,s.lN)(u));return f[1]=f[1]-e,p(f)}o.fG(Float64Array)}}]);